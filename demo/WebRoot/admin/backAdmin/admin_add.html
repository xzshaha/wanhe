<!DOCTYPE html>
<html>
  <head>
    <title>添加管理人员</title>
	
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="css/comment.css"/>
    
  </head>
  
  <body>
   <div class="row">
		<div class="col-lg-12 col-sm-12 col-xs-12">
			<form id="form1">
				<!--<div class="form-inline" role="form">-->
					<div class="col-lg-6 col-sm-6 col-xs-6">
						<div class="form-group">
								<div class="input-group">
									<div class="input-group-addon" style="width: 160px">用户名称</div>
									<input class="form-control" name="username" id="usernames" type="text" onblur="checkUsername()" >
								</div>
								<div class="input-group">
									<div class="input-group-addon" style="width: 160px;">用户姓名</div>
									<input class="form-control" name="name" id="names" type="text" onblur="checkName()">
								</div>
								<div class="input-group">
									<div class="input-group-addon" style="width: 160px">密码</div>
									<input class="form-control" name="password" id="password" type="text" onblur="checkPwd()">
								</div>
								
								<div class="input-group">
									<div class="input-group-addon" style="width: 160px">性别</div>
									<!--<input class="form-control" name="address" id="updateAddress" type="radio">男-->
										<select id="gender">
											<option value="0">男</option>
											<option value="1">女</option>
										</select>
								</div>
								
								<div class="input-group">
									<div class="input-group-addon" style="width: 160px">角色</div>
									<!--<input class="form-control" name="address" id="updateAddress" type="radio">男-->
										<select id="role">
										
										</select>
								</div>
								
						</div>
					</div>
					
					
					<div class="col-lg-6 col-sm-6 col-xs-6">
						<div class="form-group">
							<div class="input-group">
								<div class="input-group-addon" style="width: 160px">联系电话</div>
								<input class="form-control" name="mobile" id="mobiles" type="text" onblur="checkMobile()">
							</div>
							<div class="input-group">
									<div class="input-group-addon" style="width: 160px" >年龄</div>
									<input class="form-control" name="age" id="age" type="text" onblur="checkAge()">
								</div>
								<div class="input-group">
									<div class="input-group-addon" style="width: 160px">邮箱</div>
									<input class="form-control" name="email" id="email" type="text" onblur="checkEmail()">
								</div>
								<div class="input-group">
									<div class="input-group-addon" style="width: 160px">工作年限</div>
									<input class="form-control" name="workTime" id="workTime" type="text" onblur="checkWorkTime()">
								</div>
								<!-- <div class="input-group">
									<div class="input-group-addon" style="width: 160px">是否锁定</div>
									<input class="form-control" name="address" id="updateAddress" type="radio">男
										<select id="isLocked">
											<option value="true">是</option>
											<option value="false">否</option>
										</select>
								</div> -->
						</div>
					</div>
			</form>
			
		</div>
	</div>
	<br>
	<br>
	<div class="col-lg-12 col-sm-12 col-xs-12" id="shroBox">
		<a  style="margin-left: 62%" id="addSchool" class="btn btn-blue"><i class="fa fa-plus"></i> 添加</a>
		<a class="btn layui-layer-close"><i class="fa fa-power-off"></i> 取消</a>
	</div>
	<script type="text/javascript" src="js/add_adminUser.js" ></script>
	<script>
	$(function(){
		getRole();
	});
	function getRole(){
		$.ajax({
			type: "get",
			async : false,  //同步请求
			url: ipAddress+"/admin/role/list.do", //请求接口
			data:{},
			dataType:"json",
			timeout:5000, 
			success:function(json){
				if(json.status==0){
					var list = json.data;
					var html = "";
 	            	for(var i = 0; i < list.length; i++){
 	            		html+="<option value='"+list[i].roleId+"'>"+list[i].name+"</option>";
 	            	}
 	            	$("#role").html(html);
				}else if(json.status==1){
					layer.msg(json.message);
				}else{
					layer.msg(json.message);
				}
			},
			error:function(){
				layer.msg(json.message);
			}
	   });
	}
	$("#usernames").blur(function(){
		if(checkUsername()==true){
			var username = $("#usernames").val();
			$.ajax({
				type: "get",
				async : false,  //同步请求
				url: ipAddress+"/admin/admin/checkUserNameByJson", //请求接口
				data:{username:username},
				dataType:"json",
				timeout:5000, 
				success:function(json){
					if(json.status==0){
						
					}else if(json.status==1){
						$("#usernames").val("");
						layer.msg(json.message);
					}else{
						$("#usernames").val("");
						layer.msg(json.message);
					}
				},
				error:function(){
					layer.msg(json.message);
				}
		   });
		}
		 
		
	});
	
	
			$("#addSchool").click(function(){
				addAdmin();
			});
		 function addAdmin(){ 
			 	var name = $("#names").val();
			 	var username = $("#usernames").val();
			 	var passwords = $("#password").val();
			 	var mobile = $("#mobiles").val();
			 	var workTime = $("#workTime").val();
			 	var age = $("#age").val();
			 	var email = $("#email").val();
			 	var genderIndex=$("#gender option:selected").val();
			 	var roleId=$("#role option:selected").val();
			 	/* var isLocked=$("#isLocked option:selected").val(); */
			 	if(checkUsername()==true && checkName()==true && checkPwd()==true && checkMobile()==true && checkAge()==true && checkWorkTime()==true){
			 		$.ajax({
						type: "get",
						async : false,  //同步请求
						url: ipAddress+"/admin/admin/saveByJson", //请求接口
						data:{name:name,username:username,password:passwords,gender:genderIndex,mobile:mobile,
							workTime:workTime,age:age,email:email,type:0,role:roleId},
						dataType:"json",
						timeout:5000, 
						success:function(json){
							if(json.status==0){
								closeDialog();
								var num = sessionStorage.getItem("num");
								if(num==undefined){
									getDatas(1);
								}else{
									getDatas(num);
								}
			 	            	layer.msg(json.message);
							}else{
								layer.msg(json.message);
							}
						},
						error:function(){
							layer.msg(json.message);
						}
				   });
			 	}else{
			 		
			 	}
			 	
		 }
		 
		 function closeDialog(){
			 $(".layui-layer").remove();
			 $(".layui-layer-shade").remove();
		 }
		
	</script>
	
	
	
  </body>
</html>
